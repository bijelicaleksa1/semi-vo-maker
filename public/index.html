<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Semi Truck TikTok VO Maker</title>
<style>body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:24px} .card{border:1px solid #ddd;border-radius:12px;padding:16px;margin:12px 0} label{display:block;margin:6px 0 2px;font-weight:600} input{width:100%;padding:8px;border:1px solid #ccc;border-radius:8px} button{padding:10px 16px;border:0;border-radius:10px;cursor:pointer} .btn{background:#111;color:#fff} .btn.secondary{background:#f2f2f2;color:#111}</style>
</head><body>
<h1>üéôÔ∏è Semi Truck TikTok Voiceover Maker</h1>
<div class="card">
  <label>Make*</label><input id="make" value="Freightliner"/>
  <label>Model*</label><input id="model" value="Cascadia"/>
  <label>Year</label><input id="year" placeholder="2021"/>
  <label>Engine</label><input id="engine" placeholder="Detroit DD15"/>
  <label>Transmission</label><input id="transmission" placeholder="DT12 automatic"/>
  <label>Mileage</label><input id="mileage" placeholder="~450,000 miles"/>
  <label>Axle</label><input id="axle" placeholder="6x4, 2.64 ratio"/>
  <label>Sleeper</label><input id="sleeper" placeholder='72" sleeper'/>
  <label>Tech/Safety</label><input id="tech" placeholder="Detroit Assurance, adaptive cruise"/>
  <label>Selling Points</label><input id="sellingPoints" placeholder="Strong MPG, fleet maintained"/>
  <label>Use Case</label><input id="useCase" placeholder="OTR / regional / owner-op"/>
  <label>Location</label><input id="location" value="Milwaukee"/>
  <label>Range</label><input id="range" value="nationwide"/>
  <label>Contact</label><input id="contact" value="DM me for details"/>
  <div style="margin-top:12px;display:flex;gap:8px">
    <button class="btn" id="genBtn">Generate 3 Voiceovers</button>
    <button class="btn secondary" id="resetBtn">Reset</button>
  </div>
  <p id="status"></p>
</div>

<div class="card" id="results" style="display:none">
  <h2>Results</h2>
  <div id="list"></div>
  <button class="btn" id="zipBtn">Download Selected as ZIP</button>
</div>

<script>
const statusEl = document.getElementById('status'), listEl = document.getElementById('list'), resultsEl = document.getElementById('results');
const v = id => document.getElementById(id).value.trim();
document.getElementById('resetBtn').onclick = () => location.reload();
document.getElementById('genBtn').onclick = async () => {
  statusEl.textContent = 'Generating...';
  const specs = { make:v('make'), model:v('model'), year:v('year'), engine:v('engine'), transmission:v('transmission'), mileage:v('mileage'), axle:v('axle'), sleeper:v('sleeper'), tech:v('tech'), sellingPoints:v('sellingPoints'), useCase:v('useCase'), location:v('location')||'Milwaukee', range:v('range')||'nationwide', contact:v('contact')||'DM me for details' };
  if (!specs.make || !specs.model) return alert('Make/Model required');
  const r = await fetch('/generate', { method:'POST', headers:{'Content-Type':'application/json' }, body: JSON.stringify({ specs }) });
  const j = await r.json(); if (j.error) return alert(j.error);
  resultsEl.style.display = 'block';
  listEl.innerHTML = j.files.map((f,i)=>`
    <div class="card">
      <h3>${f.label}</h3>
      <audio controls src="${f.url}"></audio><br/>
      <a class="btn secondary" href="${f.url}" download="voiceover_${i+1}.mp3">Download MP3</a>
      <div><label><input type="checkbox" name="pick" value="${f.url}"> Select</label></div>
      <details><summary>Script</summary><pre>${f.script.replace(/[&<>"']/g,c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;' }[c]))}</pre></details>
      <details><summary>On-screen Beats</summary><ul>${(f.beats||[]).map(b=>`<li>${b}</li>`).join('')}</ul></details>
      <p><b>Hashtags:</b> ${(f.hashtags||[]).join(' ')}</p>
    </div>`).join('');
  statusEl.textContent = 'Done.';
};
document.getElementById('zipBtn').onclick = async () => {
  const sel = [...document.querySelectorAll('input[name="pick"]:checked')].map(x=>x.value);
  if (!sel.length) return alert('Select at least one');
  const r = await fetch('/zip', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ files: sel }) });
  const blob = await r.blob(); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='voiceovers.zip'; a.click();
};
</script>
</body></html>
